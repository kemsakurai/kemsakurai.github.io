{"name":"Kemsakurai.GitHub.io","tagline":"","body":"# MonoTalk\r\nこのライブラリはAndroid用のORマッピングライブラリです。\r\n煩雑な実装になりがちなAndroidのDB周辺実装を簡略化することを目的としています。  \r\nアンドロイドアプリを作っていたつもりでしたが、アプリはできずにライブラリが。。      \r\n[Active Android](https://github.com/pardom/ActiveAndroid), [Ollie](https://github.com/pardom/ollie/), [Sprinkles](https://github.com/emilsjolander/sprinkles),\r\n[DBFlow](https://github.com/Raizlabs/DBFlow),[greenDAO](http://greendao-orm.com),[DBFlute](http://dbflute.seasar.org),[S2JDBC](http://s2container.seasar.org/2.4/ja/s2jdbc.html)\r\n等の実装を参考にしながら作成しています。  \r\n基本機能は動作しますが、外部IFなどはまだ変更予定です。\r\n\r\n\r\n## 機能概要\r\n当ライブラリには以下の機能があります。\r\n- Entityクラスに記述したアノテーションからテーブルを作成します。\r\n- 複数DBの管理が可能です。\r\n- TABLEクラスからクエリを作成し、単純なCRUDな可能です。\r\n- 少し難しいクエリはクエリオブジェクトを使用して作成が可能です。\r\n- 難しいクエリは2waysqlを作成して実行が可能です。\r\n\r\n\r\n## 導入方法\r\nbuild.gradleに以下のmavenリポジトリの設定を追加してください。  \r\n\r\n    repositories {\r\n          maven { url 'https://kemsakurai.github.io/maven/master/releases' }\r\n    }\r\n    \r\nbuild.gradleの以下の依存関係を追加してください。  \r\n    \r\n    dependencies {\r\n         compile 'MonoTalk:monotalk-db:0.0.1'\r\n    }\r\n\r\n## 使用方法\r\n\r\nApplicationを継承したクラスに以下のような記述を追加してください。  \r\n\r\n```java\r\n\tpublic class SampleApplication extends android.app.Application {\r\n\t    \r\n\t\t@Override\r\n    \tpublic void onCreate() {\r\n        \tsuper.onCreate();\r\n\r\n\t\t\t// builderをnewする\r\n\t        DatabaseConfigration.Builder builder = new DatabaseConfigration.Builder();\r\n    \t    // batabase名を設定\r\n\t\t\tbuilder.setDataBaseName(\"NotesDB\");\r\n\t\t\t// version番号を設定\r\n        \tbuilder.setVersion(1);\r\n\t\t\t// default(プライマリ?) Databaseとして使用する場合,true (初期値true)\r\n        \tbuilder.setDefalutDatabase(true);\r\n        \t// Databaseに関連づけするEntityクラスを設定\r\n\t\t\tbuilder.addTable(Notes.class);\r\n        \tbuilder.addTable(NoteTag.class);\r\n        \tbuilder.addTable(Tag.class);\r\n\t\t\t// 初期化\r\n        \tMonoTalk.init(getApplicationContext(), builder.create());\r\n\t\t}\r\n\t\t\r\n\t\t@Override\r\n\t    public void onTerminate() {\r\n        \tsuper.onTerminate();\r\n\t        MonoTalk.dispose();\r\n    \t}\r\n\t}\r\n```\r\n\r\n## Entity(Table)クラスの作成\r\n\r\n- DATABASEのテーブル定義に対応するEntityクラスを作成します。  \r\n(初期化時にEntityクラスの指定が必要になるので、実際はこちらを先に実施すると思います。)  \r\n- EntityクラスはEntityを継承して作成する必要があります。  \r\n- @Tableアノテーションで作成するTableを指定し、    \r\n@Columnアノテーションで作成するColumn名を指定します。  \r\n- @ColumnにはPK指定はできません。  \r\n(Create Table DDL実行時に、_id カラムをAUTOINCREMENT 指定の主キーとして作成します。)  \r\n- 自然キーとなる項目には、Columnアノテーションのuniqe属性、  \r\nもしくは、@UniqeアノテーションでUniqe制約を付与してください。  \r\n\r\n```java\r\n\t@Table(name = \"NOTES\")\r\n    public class Notes extends Entity {\r\n        public static final String TITLE = \"TITLE\";\r\n        public static final String BODY = \"BODY\";\r\n        public static final String DATE = \"DATE\";\r\n\r\n        @Column(name = TITLE)\r\n        public String title;\r\n\r\n        @Column(name = BODY)\r\n        @NotNull\r\n        public String body;\r\n\r\n        @Column(name = DATE)\r\n        public Date date;\r\n    }\r\n```\r\n## データの登録 更新 削除  \r\n\r\n  EntityManagerクラスを使用した単純なCRUD    \r\n  クエリオブジェクトを使用したCRUD  \r\n\t2waysqlを使用したCRUDが実行できます。  \r\n\t*2waysqlは現在READのみ可能です。\r\n\t\r\n#### EntityManagerクラスを使用したCRUD\r\nINSERT  \r\n```java\r\n\tEntityManager manager = MonoTalk.getDBManagerByDefaultDbName();\r\n    Notes notes = new Notes();\r\n    notes.title = \"Title1\";\r\n    notes.body = \"Hello World1\";\r\n    long id = manager.insert(notes);\r\n\r\n\t// ## Null除外する際は、insertExcludesNullが使用可能です。\r\n    Notes notes = new Notes();\r\n    notes.title = null;\r\n    notes.body = \"Hello World1\";\r\n    long id = manager.insertExcludesNull(notes);\r\n```\r\nUPDATE  \r\n\r\n```java\r\n\tEntityManager manager = MonoTalk.getDBManagerByDefaultDbName();\r\n\tNotes notes = new Notes();\r\n    long id = 111l;\r\n    notes.setId(id);\r\n    notes.title = \"Title1\";\r\n    notes.body = \"Hello World1\";\r\n    manager.update(notes);\r\n\r\n\t// ## Null除外する際は、updateExcludesNullが使用可能です。\r\n\tNotes notes = new Notes();\r\n    long id = 111l;\r\n    notes.setId(id);\r\n    notes.title = null;\r\n    notes.body = \"Hello World1\";\r\n\tmanager.updateExcludesNull(notes);\r\n\t\r\n\t// ## SQliteDatabaseと同じようなIFでの更新が可能です\r\n    ContentValues value = new ContentValues();\r\n    value.put(Notes.TITLE, \"TEST\");\r\n    manager.updateById(Notes.class, value, 1l);\r\n```\r\nDELETE\r\n```java\r\n\tEntityManager manager = MonoTalk.getDBManagerByDefaultDbName();\r\n    Notes notes = new Notes();\r\n    long id = 111l;\r\n    notes.setId(id);\r\n    manager.delete(notes);\r\n\r\n    // Class と IDを指定して削除する\r\n    manager.deleteById(Notes.class, 111l);\r\n    // Class Where句 Bind変数を指定して削除する\r\n    manager.delete(Notes.class, \"_id=?\", 111l);\r\n    // Table Where句 Bind変数を指定して削除する\r\n    manager.delete(\"NOTES\",  \"_id=?\", 111l);\t\r\n```\r\n\r\n### クエリオブジェクトを使用したCRUD  \r\nクエリオブジェクトはentitymanagrのnew...で始まるメソッドを使用して生成します。  \r\n\r\n```java\r\n    EntityManager manager = MonoTalk.getDBManagerByDefaultDbName();\r\n    manager.newInsertInto(Notes.class).value(Notes.TITLE, \"TEST\").execute();\r\n\t\r\n\t// monotalk.db.query.QueryBuilder#toValuesExcludesColumns()をstatic importして、\r\n\t// EntityオブジェクトからContentsValueを生成して登録します。\r\n\tEntityManager manager = MonoTalk.getDBManagerByDefaultDbName();\r\n    Notes notes = new Notes();\r\n    notes.body = \"Hello World1\";\r\n    manager.newInsertInto(Notes.class).values(toValuesExcludesColumns(notes, Notes.TITLE)).execute();\r\n\t\r\n\t\r\n```\r\nupdate,deleteについては今後ドキュメントを作成します。\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}